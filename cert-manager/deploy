#!/usr/bin/env bash


# kubectl delete -f cert-manager-v1.3.1.yml
# kubectl delete -f cert-manager-v1.8.0.yml

kubectl apply -f cert-manager-v1.8.0.yml

# Need to wait for the CRDs to be created before we can start making issuers.
# old kubectl wait -f cert-manager-v1.8.0.yml --for condition="established" --timeout=60s

# more specific one doesn't work because webhook aren't ready
# kubectl wait --for condition=established --timeout=60s crd/clusterissuers.cert-manager.io

# This might not work:
kubectl wait -f cert-manager-v1.8.0.yml --for condition=established --timeout=60s

kubectl apply -f letsencrypt-staging.yaml

kubectl apply -f letsencrypt-prod.yaml
